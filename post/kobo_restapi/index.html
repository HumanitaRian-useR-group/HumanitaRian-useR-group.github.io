<!DOCTYPE HTML>

<html>
    <head>
        
            
                <title>Accessing data from REST API using R: examples for KoBoToolbox and Country Based Pooled Fund (CBPF) data</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.54.0" />
        


        
            <meta name="author" content="Punya Prasad Sapkota">
        
        
            
                <meta name="description" content="The humanitarian data analysis professional community shall work towards using a common and open language to build interoperable and transparent analysis standards for joint needs assessments and to obtain maximum value for any data collected.">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Accessing data from REST API using R: examples for KoBoToolbox and Country Based Pooled Fund (CBPF) data"/>
<meta name="twitter:description" content="R program has become a language of choice for data science work. It has rich feature library that can be readily used for variety of data management tasks. This article focuses on accessing data from the KoBoToolbox.
 KoBoToolbox KoBoToolbox provides a suite of tools for field data collection in the challenging environments. It is free and open source and works both on and offline.
KoBoToolbox has a number of advanced features which are very useful for advanced use case scenario."/>

        <meta property="og:title" content="Accessing data from REST API using R: examples for KoBoToolbox and Country Based Pooled Fund (CBPF) data" />
<meta property="og:description" content="R program has become a language of choice for data science work. It has rich feature library that can be readily used for variety of data management tasks. This article focuses on accessing data from the KoBoToolbox.
 KoBoToolbox KoBoToolbox provides a suite of tools for field data collection in the challenging environments. It is free and open source and works both on and offline.
KoBoToolbox has a number of advanced features which are very useful for advanced use case scenario." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/kobo_restapi/" />
<meta property="article:published_time" content="2018-12-08T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-12-08T00:00:00&#43;00:00"/>

        <meta property="og:image" content="//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        
<meta itemprop="name" content="Accessing data from REST API using R: examples for KoBoToolbox and Country Based Pooled Fund (CBPF) data">
<meta itemprop="description" content="R program has become a language of choice for data science work. It has rich feature library that can be readily used for variety of data management tasks. This article focuses on accessing data from the KoBoToolbox.
 KoBoToolbox KoBoToolbox provides a suite of tools for field data collection in the challenging environments. It is free and open source and works both on and offline.
KoBoToolbox has a number of advanced features which are very useful for advanced use case scenario.">


<meta itemprop="datePublished" content="2018-12-08T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-12-08T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1396">



<meta itemprop="keywords" content="Punya-Prasad-Sapkota,IMMAP," />

        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="/css/main.css">
            <link rel="stylesheet" href="/css/add-on.css">
            <link rel="stylesheet" href="/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-131350181-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

      
            <script
			  src="http://code.jquery.com/jquery-3.3.1.min.js"
			  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
			  crossorigin="anonymous"></script>
			  
    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      
        <h1><a href="/">post</a></h1>
      
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="/post/index.html">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="/about/">
                            <i class="fa fa-info-circle">&nbsp;</i>About
                    </a>
                </li>
            
                <li>
                    <a href="/tags/">
                            <i class="fa fa-newspaper-o">&nbsp;</i>Contributors
                    </a>
                </li>
            
                <li>
                    <a href="/categories/">
                            <i class="fa fa-database">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="https://join.skype.com/qYBKC5q3wKp4">
                            <i class="fa fa-phone">&nbsp;</i>Join the Skype-group
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="/post/index.html">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/about/">
                            <h3>
                                <i class="fa fa-info-circle">&nbsp;</i>About
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags/">
                            <h3>
                                <i class="fa fa-newspaper-o">&nbsp;</i>Contributors
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories/">
                            <h3>
                                <i class="fa fa-database">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://join.skype.com/qYBKC5q3wKp4">
                            <h3>
                                <i class="fa fa-phone">&nbsp;</i>Join the Skype-group
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/conjoint-analysis/">Conjoint analysis: modeling judgement to calibrate vulnerability scoring</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-03-19'>
                                    March 19, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/analytic-hierachy-process/">Using Analytic Hierarchy Process to weight vulnerability scorecard</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-02-23'>
                                    February 23, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/deprivation/">A practical implementation of deprivation model: index of protection risks</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-01-23'>
                                    January 23, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/geonames/">Fuzzy geocoding on location name</a></h3>
                                
                                <time class="published" datetime=
                                    '2019-12-14'>
                                    December 14, 2019</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/profile-of-preference/">Profile of preference: Rashtree analysis</a></h3>
                                
                                <time class="published" datetime=
                                    '2019-12-10'>
                                    December 10, 2019</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/plackett-luce/">Estimation of sectoral priorities: Borda Count &amp; Plackett-Luce model</a></h3>
                                
                                <time class="published" datetime=
                                    '2019-12-03'>
                                    December 3, 2019</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="/post/compositeindicator/">Building Severity Index with R</a></h3>
                                
                                <time class="published" datetime=
                                    '2019-11-28'>
                                    November 28, 2019</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /post/
                        
                        class="button">See more</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="//twitter.com/share?url=%2fpost%2fkobo_restapi%2f&amp;text=Accessing%20data%20from%20REST%20API%20using%20R%3a%20examples%20for%20KoBoToolbox%20and%20Country%20Based%20Pooled%20Fund%20%28CBPF%29%20data&amp;via=" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>




<li>
  <a href="//plus.google.com/share?url=%2fpost%2fkobo_restapi%2f" target="_blank" class="share-btn google-plus">
    <i class="fa fa-google-plus"></i>
    <p>Google+</p>
  </a>
</li>





<li>
  <a href="//www.facebook.com/sharer/sharer.php?u=%2fpost%2fkobo_restapi%2f" target="_blank" class="share-btn facebook">
    <i class="fa fa-facebook"></i>
    <p>Facebook</p>
    </a>
</li>




<li>
  <a href="//reddit.com/submit?url=%2fpost%2fkobo_restapi%2f&amp;title=Accessing%20data%20from%20REST%20API%20using%20R%3a%20examples%20for%20KoBoToolbox%20and%20Country%20Based%20Pooled%20Fund%20%28CBPF%29%20data" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=%2fpost%2fkobo_restapi%2f&amp;title=Accessing%20data%20from%20REST%20API%20using%20R%3a%20examples%20for%20KoBoToolbox%20and%20Country%20Based%20Pooled%20Fund%20%28CBPF%29%20data" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>




<li>
  <a href="//www.stumbleupon.com/submit?url=%2fpost%2fkobo_restapi%2f&amp;title=Accessing%20data%20from%20REST%20API%20using%20R%3a%20examples%20for%20KoBoToolbox%20and%20Country%20Based%20Pooled%20Fund%20%28CBPF%29%20data" target="_blank" class="share-btn stumbleupon">
    <i class="fa fa-stumbleupon"></i>
    <p>StumbleUpon</p>
  </a>
</li>




<li>
  <a href="//www.pinterest.com/pin/create/button/?url=%2fpost%2fkobo_restapi%2f&amp;description=Accessing%20data%20from%20REST%20API%20using%20R%3a%20examples%20for%20KoBoToolbox%20and%20Country%20Based%20Pooled%20Fund%20%28CBPF%29%20data" target="_blank" class="share-btn pinterest">
    <i class="fa fa-pinterest-p"></i>
    <p>Pinterest</p>
  </a>
</li>




<li>
  <a href="mailto:?subject=Check out this post by Punya%20Prasad%20Sapkota&amp;body=%2fpost%2fkobo_restapi%2f" target="_blank" class="share-btn email">
    <i class="fa fa-envelope"></i>
    <p>Email</p>
  </a>
</li>


        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="/post/kobo_restapi/">Accessing data from REST API using R: examples for KoBoToolbox and Country Based Pooled Fund (CBPF) data</a></h1>
            
        
        
    </div>
    <div class="meta">
        <time class="published"
            datetime='2018-12-08 00:00:00 &#43;0000 UTC'>
            December 8, 2018</time>
        <span class="author">Punya Prasad Sapkota</span>
        
            <p>7 minutes read</p>
        
    </div>
</header>


  

  

  
  <div>
     
 <div id="go-to-folding-div" style="display: inline-block;vertical-align: top;height: 1px;margin-top: -4em;"></div>
 <div id="code-folding-buttons" class="btn-group pull-right">
   <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast="">
     <span>Show/Hide all code</span> 
     <span class="caret"></span>
   </button>
   <ul class="dropdown-menu" style="min-width: 50px;">
   <li><a id="rmd-show-all-code" href="#go-to-folding-div">Show All Code</a>
   </li><li><a id="rmd-hide-all-code" href="#go-to-folding-div">Hide All Code</a></li>
   </ul>
 </div>
 

    <br/>
    <div id="content" class="article-entry">
      


<p>R program has become a language of choice for data science work. It has rich feature library that can be readily used for variety of data management tasks. This article focuses on accessing data from the <a href="https://kobo.humanitarianresponse.info/">KoBoToolbox</a>.</p>
<!--MORE-->
<div id="kobotoolbox" class="section level1">
<h1>KoBoToolbox</h1>
<p><a href="http://support.kobotoolbox.org/getting-started/welcome/welcome-to-kobotoolbox">KoBoToolbox</a> provides a suite of tools for field data collection in the challenging environments. It is free and open source and works both on and offline.</p>
<p>KoBoToolbox has a number of advanced features which are very useful for advanced use case scenario. KoBoToolbox has made data accessible through the implementation of <a href="https://kc.humanitarianresponse.info/api/v1/data">REST API</a>. This provides enormous possibility of automating the workflow of survey data collection, processing and analysis. Even if accessibility of the data has not been set as public, data can be fetched by passing username and password of the KoBo account. KoBoToolbox has two APIs access points namely kpi and kc. The toolbox started supporting form deployments and access to data using ‘kc’ API. In the latest version, ‘kpi’ has been implemented as the primary <a href="http://support.kobotoolbox.org/managing-your-project-s-data/rest-services">API</a>.</p>
<p>This article is written to demostrates the methods to access data from KoBo using R program.</p>
<div id="main-packages-used" class="section level2">
<h2>Main packages used:</h2>
<pre class="r"><code>library(httr)
library(jsonlite)
#for reading and writing data
library(readr) # to read CSV data
library(openxlsx) # to write to excel file</code></pre>
<p>Package ‘httr’ has very useful tools for working with HTTP requests such as GET, POST, PATCH etc. In addition, we can pass parameters such as authentication information etc. The ‘jsonlite’ package offers flexible, robust, high performance tools for working with JSON data.</p>
<p>First of all, let’s set the KoBo server URL.</p>
</div>
<div id="kobotoolbox-example" class="section level2">
<h2>KoBoToolbox Example</h2>
<pre class="r"><code>####----set global variables ----------
kobo_server_url&lt;-&quot;https://kobo.humanitarianresponse.info/&quot;
kc_server_url&lt;-&quot;https://kc.humanitarianresponse.info/&quot;</code></pre>
<p>To download data, unique identifier of the form is required to construct the url to fetch data. In the older API version 1, forms/projects deployed to collect data has unique six digit identifier (for example, 145448). With the ID of the form, KoBo data download URL can be constructed as:</p>
<pre class="r"><code>form_id&lt;-253043 #change the id to your form&#39;s id
url&lt;-paste0(kc_server_url,&quot;api/v1/data/&quot;,form_id,&quot;.csv&quot;)
#returns the CSV content of the form</code></pre>
<p>Above url points to the CSV content of the form data that can be easily transformed to R dataframe for further processing.</p>
<p>To download the data, GET request is made. If data is not available publicly, username and password of the KoBo account need to be passed as authentication parameter.</p>
<pre class="r"><code>#supply url for the data
rawdata&lt;-GET(url)
#if form data is not accessible publicly, then username and password needs to be provided. 
#Use the following code to download the data.
#u&lt;-&quot;username&quot;
#pw&lt;-&quot;password&quot;
#rawdata&lt;-GET(url,authenticate(u,pw),progress())</code></pre>
<p>The server responds with a status code which needs to be checked for its successful return of the requested information before further processing of the information.</p>
<pre class="r"><code>print(paste0(&quot;Status Code: &quot;,rawdata$status_code))</code></pre>
<pre><code>## [1] &quot;Status Code: 200&quot;</code></pre>
<p>When an API call responds to a request, the data is returned as a list. The list has many different items and the most of the items are administrative information from the API. It is suggested to explore the list elements to understand the information so that required piece of data can be extracted correctly.</p>
<pre class="r"><code># to check the elements returned:
str(rawdata)</code></pre>
<pre><code>## List of 10
##  $ url        : chr &quot;https://kc.humanitarianresponse.info/api/v1/data/253043.csv&quot;
##  $ status_code: int 200
##  $ headers    :List of 8
##   ..$ date               : chr &quot;Fri, 29 Nov 2019 22:31:10 GMT&quot;
##   ..$ content-type       : chr &quot;application/csv&quot;
##   ..$ content-length     : chr &quot;68467&quot;
##   ..$ server             : chr &quot;nginx/1.10.3 (Ubuntu)&quot;
##   ..$ content-disposition: chr &quot;attachment; filename=aUBanmH6zXuLaDfUyoSbZB_2019_11_29.csv&quot;
##   ..$ content-language   : chr &quot;en&quot;
##   ..$ vary               : chr &quot;Accept, Accept-Language, Cookie&quot;
##   ..$ allow              : chr &quot;GET, POST, PATCH, DELETE, HEAD, OPTIONS&quot;
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;insensitive&quot; &quot;list&quot;
##  $ all_headers:List of 1
##   ..$ :List of 3
##   .. ..$ status : int 200
##   .. ..$ version: chr &quot;HTTP/2&quot;
##   .. ..$ headers:List of 8
##   .. .. ..$ date               : chr &quot;Fri, 29 Nov 2019 22:31:10 GMT&quot;
##   .. .. ..$ content-type       : chr &quot;application/csv&quot;
##   .. .. ..$ content-length     : chr &quot;68467&quot;
##   .. .. ..$ server             : chr &quot;nginx/1.10.3 (Ubuntu)&quot;
##   .. .. ..$ content-disposition: chr &quot;attachment; filename=aUBanmH6zXuLaDfUyoSbZB_2019_11_29.csv&quot;
##   .. .. ..$ content-language   : chr &quot;en&quot;
##   .. .. ..$ vary               : chr &quot;Accept, Accept-Language, Cookie&quot;
##   .. .. ..$ allow              : chr &quot;GET, POST, PATCH, DELETE, HEAD, OPTIONS&quot;
##   .. .. ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;insensitive&quot; &quot;list&quot;
##  $ cookies    :&#39;data.frame&#39;: 0 obs. of  7 variables:
##   ..$ domain    : logi(0) 
##   ..$ flag      : logi(0) 
##   ..$ path      : logi(0) 
##   ..$ secure    : logi(0) 
##   ..$ expiration: &#39;POSIXct&#39; num(0) 
##   ..$ name      : logi(0) 
##   ..$ value     : logi(0) 
##  $ content    : raw [1:68467] 51 5f 45 2f ...
##  $ date       : POSIXct[1:1], format: &quot;2019-11-29 22:31:10&quot;
##  $ times      : Named num [1:6] 0 0.183 0.314 0.595 0.97 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;redirect&quot; &quot;namelookup&quot; &quot;connect&quot; &quot;pretransfer&quot; ...
##  $ request    :List of 7
##   ..$ method    : chr &quot;GET&quot;
##   ..$ url       : chr &quot;https://kc.humanitarianresponse.info/api/v1/data/253043.csv&quot;
##   ..$ headers   : Named chr &quot;application/json, text/xml, application/xml, */*&quot;
##   .. ..- attr(*, &quot;names&quot;)= chr &quot;Accept&quot;
##   ..$ fields    : NULL
##   ..$ options   :List of 2
##   .. ..$ useragent: chr &quot;libcurl/7.58.0 r-curl/4.2 httr/1.4.1&quot;
##   .. ..$ httpget  : logi TRUE
##   ..$ auth_token: NULL
##   ..$ output    : list()
##   .. ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;write_memory&quot; &quot;write_function&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;request&quot;
##  $ handle     :Class &#39;curl_handle&#39; &lt;externalptr&gt; 
##  - attr(*, &quot;class&quot;)= chr &quot;response&quot;</code></pre>
<p>The main raw data of interest is returned with ‘content’ tag. In addition, when content has non-English characters, for example Arabic texts, we can encode the output as ‘UTF-8’ to ensure that the information is retained in its original form and encoding.</p>
<pre class="r"><code>d_content &lt;- content(rawdata,&quot;raw&quot;,encoding=&quot;UTF-8&quot;)</code></pre>
<p>The raw content can be parsed to CSV format by using read_csv() function from ‘readr’ package.</p>
<pre class="r"><code>d_content_csv &lt;- read_csv(d_content)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_character(),
##   `Q_E/Q_E1` = col_double(),
##   `Q_E/Q_E2` = col_date(format = &quot;&quot;),
##   `Q_E/Q_E3` = col_double(),
##   `Q_E/Q_E5` = col_double(),
##   `Q_E/Q_E6` = col_double(),
##   `gchoose_th/inter_sect` = col_logical(),
##   `gchoose_th/cccm` = col_logical(),
##   `gchoose_th/education` = col_logical(),
##   `gchoose_th/nfi_shelte` = col_logical(),
##   `gchoose_th/food_secur` = col_logical(),
##   `gchoose_th/health_sec` = col_logical(),
##   `gchoose_th/early_reco` = col_logical(),
##   `gchoose_th/protection` = col_logical(),
##   `I_S_Q/Q_K1/Q_K1_B` = col_double(),
##   `I_S_Q/Q_K1/Q_K1_E` = col_date(format = &quot;&quot;),
##   `I_S_Q/aap_group/Q1_1_4/food` = col_logical(),
##   `I_S_Q/aap_group/Q1_1_4/nfi` = col_logical(),
##   `I_S_Q/aap_group/Q1_1_4/shelter` = col_logical(),
##   `I_S_Q/aap_group/Q1_1_4/wash` = col_logical(),
##   `I_S_Q/aap_group/Q1_1_4/nutrition` = col_logical()
##   # ... with 472 more columns
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<p>Let’s change it to the R data frame object.</p>
<pre class="r"><code>d_content_csv &lt;- as.data.frame(d_content_csv)</code></pre>
<p>To save it to the external CSV or even excel file, we can use any csv or xlsx writer functions available in R packages.</p>
<pre class="r"><code>#using openxlsx package to save data
openxlsx::write.xlsx(d_content_csv,&quot;kobo_data.xlsx&quot;,sheetName=&quot;data&quot;, row.names = FALSE)</code></pre>
<pre><code>## Note: zip::zip() is deprecated, please use zip::zipr() instead</code></pre>
<p>Let’s look at another example where data is in the JSON format. When downloading data, it is a common practice to check the number of submissions. The data download request is made only if the form has one or more records.</p>
<pre class="r"><code>#submission count
d_count_subm&lt;-0 #initialise
#returns number of data submisstion in each form
stat_url&lt;- paste0(kc_server_url,&quot;api/v1/stats/submissions/&quot;,form_id,&quot;?group=anygroupname&quot;)
rawdata_stat&lt;-GET(stat_url)
#supply user name and password if data is not publicly available
#rawdata_stat&lt;-GET(stat_url,authenticate(u,pw),progress())
d_content_stat &lt;- rawToChar(rawdata_stat$content)
d_content_stat &lt;- fromJSON(d_content_stat)
d_count_submission &lt;- d_content_stat$count
  #check whether there is record or not
if (is.null(d_count_submission)){
    d_count_submission &lt;-0
}</code></pre>
</div>
</div>
<div id="country-based-pooled-fund-api" class="section level1">
<h1>Country Based Pooled Fund API</h1>
<p>Another example to download Country Based Pooled Fund <a href="https://cbpfapi.unocha.org/vo1">CBPF data</a> using API. The CBPF has made several dataset available to access using the REST API.</p>
<pre class="r"><code>url&lt;-&quot;https://cbpfapi.unocha.org/vo1/odata/Location?poolfundAbbrv=TUR70&amp;$format=csv&quot;
#returns the CSV content of the form
rawdata&lt;-GET(url)
d_content &lt;- content(rawdata,&quot;raw&quot;,encoding=&quot;UTF-8&quot;)
d_content_csv &lt;- as.data.frame(read_csv(d_content))</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   PooledFundName = col_character(),
##   PooledFundId = col_double(),
##   AllocationTypeId = col_double(),
##   AllocationYear = col_double(),
##   AllocationSourceName = col_character(),
##   ChfId = col_double(),
##   ChfProjectCode = col_character(),
##   Location = col_character(),
##   ActivityName = col_character(),
##   Men = col_double(),
##   Women = col_double(),
##   Boys = col_double(),
##   Girls = col_double(),
##   Percentage = col_double(),
##   LocationAdminLevelLatitude = col_double(),
##   LocationAdminLevelLongitude = col_double(),
##   AdminLocation1TypeName = col_character(),
##   AdminLocation1 = col_character(),
##   AdminLevel1PCode = col_character()
## )</code></pre>
<pre class="r"><code>View(d_content_csv)</code></pre>
<p>Above examples provides the list of functions and process to fetch information using REST API. A list of functions has been developed in the <a href="https://github.com/ppsapkota/kobohr_apitoolbox">KoBo APItoolbox</a>. This GitHub repo includes additional functions and utility to work with the KoBo dataset. This also includes utilities for <a href="https://kobo.humanitarianresponse.info/assets/">new KoBo API</a>.</p>
</div>

    </div>
      

  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="/categories/data">Data</a></li>
                
                
                <li><a class="article-category-link" href="/categories/kobotoolbox">KoBoToolbox</a></li>
                
                
                <li><a class="article-category-link" href="/categories/api">API</a></li>
                
                
                <li><a class="article-category-link" href="/categories/webdata">WebData</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
            
            
                <i class="fa fa-tags"></i>
                
                
                <li><a class="article-category-link" href="/tags/punya-prasad-sapkota">Punya-Prasad-Sapkota</a></li>
                
                
                <li><a class="article-category-link" href="/tags/immap">IMMAP</a></li>
                
            
        
    </ul>
  </li>
</ul>

    
 
  <script>
  $(document).ready(function () {
    window.initializeCodeFolding("show" === "hide");
  });
  </script>
  
  <script>
    window.initializeCodeFolding = function(show) {

  
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  
  var currentIndex = 1;

  
  var rCodeBlocks = $('');
  rCodeBlocks.each(function() {

    
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}

  </script>
  


  </footer>
  


</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-humanitarian-user-group-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="/post/first-meeting/"
                class="button big previous">Support the Grand Bargain commitment on Impartial &amp; Joint Needs Assessment</a></li>
    

    
        <li><a href="/post/rhdx_demo/"
                class="button big next">rhdx: a R package to interact with HDX</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='/' class="logo"><img src="/images/avatar.png" alt="HumanitaRian useR Group" /></a>
      
    
    
      <header>
        <h2></h2>
        <p>~ Science is 'show me' - not 'trust me' ~</p>
      </header>
    
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/conjoint-analysis/">Conjoint analysis: modeling judgement to calibrate vulnerability scoring</a>
              </h3>
              
              <time class="published" datetime='2020-03-19 00:00:00 &#43;0000 UTC'>
              March 19, 2020</time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/analytic-hierachy-process/">Using Analytic Hierarchy Process to weight vulnerability scorecard</a>
              </h3>
              
              <time class="published" datetime='2020-02-23 00:00:00 &#43;0000 UTC'>
              February 23, 2020</time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/deprivation/">A practical implementation of deprivation model: index of protection risks</a>
              </h3>
              
              <time class="published" datetime='2020-01-23 00:00:00 &#43;0000 UTC'>
              January 23, 2020</time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/geonames/">Fuzzy geocoding on location name</a>
              </h3>
              
              <time class="published" datetime='2019-12-14 00:00:00 &#43;0000 UTC'>
              December 14, 2019</time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/profile-of-preference/">Profile of preference: Rashtree analysis</a>
              </h3>
              
              <time class="published" datetime='2019-12-10 00:00:00 &#43;0000 UTC'>
              December 10, 2019</time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/plackett-luce/">Estimation of sectoral priorities: Borda Count &amp; Plackett-Luce model</a>
              </h3>
              
              <time class="published" datetime='2019-12-03 00:00:00 &#43;0000 UTC'>
              December 3, 2019</time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="/post/compositeindicator/">Building Severity Index with R</a>
              </h3>
              
              <time class="published" datetime='2019-11-28 00:00:00 &#43;0000 UTC'>
              November 28, 2019</time>
            </header>
            

          </article>
        
      </div>

      
        <a href=
          
            /post/
          
        class="button">See more</a>
      
    </div>
  </section>

  
  
  


  
  
    <section id="mini-bio">
      <h3>about</h3>
      <p>The humanitarian data analysis professional community shall work towards using a common and open language to build interoperable and transparent analysis standards for joint needs assessments and to obtain maximum value for any data collected.</p>
      <a href="/about" class="button">learn more</a>
    </section>
  

  
  <section id="footer">
    
    <p class="copyright">
      
        © This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please give source if you wish to quote or reproduce.
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    

    
      
    
    
    
    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/main.js"></script>
      <script src="/js/backToTop.js"></script>
    
    

    
      
        
      
    
    
    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


      
          
    
      <script src="/js/collapse.js"></script>
      <script src="/js/dropdown.js"></script>
      <script src="/js/transition.js"></script>
    
    
  </body>
</html>

